                       ### EIGRP (Enhanced Interior Gateway Routing Protocol)

-EIGRP는 1986년에 개발된 IGRP 프로토콜에 확장형으로서 Cisco전용 Protocol이다
-오직 시스코 장비에만 있다.
-Distance Vector이지만 Link-State처럼 동작을 실시한다.
 .인접성(Adjacency)을 맺은 Router상호간 Routing 업데이트를 실시
 .Link변화시 변화된 부분에 대해서 부분적인 업데이트를 실시
 .네트워크에 변화가 없으면 업데이트를 실시하지 않는다.

-Classless
 .업데이트 정보안에 SubnetMask가 포함
 .Class가 단절되어도 업데이트가 실시
 .VLSM , CIDR기능 지원
 .IP환경에서 확장성이 좋다.

-AS (Autonomous System : BGP의 AS와는 다른 개념) 하나의 관리자에 의해 사설 도메인정도. 
						 립은 도메인이 한개다.  ISP (모든정보 모아둔곳)
	Ex) 시험문제에서 EIGRP AS넘버가 다르게나온다 . 그러므로 AS넘버를 똑같이 맞추어 주면된다.
 .하나의 관리자에 의해 동작하는 지역 또는 범위 (지역 Domain)
 .1~65535
립은 서로다른 립을 못만든다. 그러나 EIGRP는 AS넘버가 다르면 서로다른 네트워크로 인식하게된다.
-AD (Administrative Distance)
 .Internal - 90  [Routing table상에 'D'로 표기]
 .External - 170  [Routing table상에 'D EX'로 표기]
 .Summary - 5 : EIGRP는 요약한 정보에 대해서 Null 0를 사용하여 관리를 실시한다 - Loop방지

-Metric : Bandwidth , Load , Delay , Reliability , MTU

-K상수 : K1 = 1 , K2 = 0 , K3 = 1 , K4 = 0 , K5 = 0

-EIGRP Metric : EIGRP B/W + EIGRP Delay
 .EIGRP B/W   : (10^7/목적지까지의 최소 Bandwidth * 256)
 .EIGRP Delay : (목적지까지 Delay의 합/10 * 256)

-로드분산
 .하나의 목적지에 대해서 복수개의 경로를 지원하는 기능
 .EIGRP는 균등/비균등 로드분산 기능을 지원한다. [Default 4개]
 .균등로드분산 : 최적경로와 동일한 metric을 가진 경로에 대해서 복수개의 경로를 지원
 .비균등로드분산 : 최적경로가 아닌 경로에 대해서 복수개의 경로를 지원하는 기능

-업데이트
 .출발지 주소는 송신하는 Interface의 IP를 사용
 .목적지 주소는  PDU나 , Network Type에 따라서 Unicast , Multicast(224.0.0.10)를 병행하여 사용한다.
 .Protocol번호 88번을 예약하여 사용
 


-------------------------------------------------------------------------------------

                   ## EIGRP가 사용하는 5가지 PDU (Hello , Update , Query , Reply , ACK)

            # Hello  (세부조건 까지 파악함)

-Neighbor를 찾고 인접성의 조건을 비교하여 인접성의 조건이 일치하면 인접성을 맺고
 								   인접성의 관계를 유지하는데 사용된다.

-EIGRP 인접성의 조건
 .AS번호 (1~65535)
 .K상수 (Default로 1,3이 사용된다.)
 .Authentication (설정시 동일한 값을 가져야 한다.)인증정보

-Hello/Hold Interval(인접성의 관계를 유지하는데 사용된다.)
 .Hello-Interval : Hello Packet을 교환하는 주기
 .Hold-Interval  : 정해진 Hold Interval안에 Hello를 수신하지 못하게되면 EIGRP인접성을 단절한다.

                                         	       Hello-Interval       Hold-Interval
-LAN : Ethernet , FastEthernet  	:             5초                   15초
-WAN : PPP , HDLC , F/R P2P  		:             5초                   15초
-WAN : F/R Multipoint , NBMA구간	:            60초                  180초

-Hello를 교환후 인접성이 완료되면 해당 Router는 EIGRP Neighbor table에 등록되어진다.
 .Neighbor table : EIGRP인접성을 맺은 목록 - show ip eigrp neighbor 

-Hello는 출발지 주소는 출구 Interface의 IP를 사용하며 목적지 주소는 Multicast(224.0.0.10)를 사용한다.
  [단 상황에 따라 Unicast로 전환가능]




            # Update
-자신의 Local정보와 Neighbor에게 수신한 네트워크 정보를 포함한 정보이다.
-EIGRP는 수신한 모든 네트워크 정보를 Topology table에 등록한다.

-EIGRP 최적경로 선출
 .Hello교환후 인접성의 조건이 동일하게되면 인접성을 맺고 neighbor table에 등록
 .자신의 Neighbor table상의 Router에게 라우팅 업데이트를 실시한다.
 .업데트를 수신한 모든 네트워크 정보를 Topology table에 저장한후
  최적경로를 선출하여 Routing table에 등록한다.

-EIGRP의 3가지  Table
 .Neighbor table : 인접성을 맺은 목록 - show ip eigrp neighbor
 .Topology table : EIGRP내의 모든 네트워크 정보 - show ip eigrp topology
 .Routing table : 최적경로 - show ip route eigrp

-Update는 출발지주소를 출구 Interface의 주소를 사용하며 목적지 주소는 네트워크 환경에 따라서
  Unicast와 Multicast를 병행하여 사용한다.
  Ethernet과 같은 Broadcast Multi-Access구간에서는 목적지를 Multicast(224.0.0.10)를 사용하며
  PPP , HDLC , Frme-relay구간에서는 목적지 주소를 Unicast를 사용한다.







            # Query
-자신의 Routing table상의 경로가 Down되었고 Topology table에 Feasble Successor가 존재하지 않거나
 자신의 Topology에 없는 네트워크 정보를 요청받게되면 Query의 확산을 실시하게된다.
 [자신에게 존재하지 않는 네트워크정보를 Neighbor에게 질의한다.]




-Query는 출발지주소를 출구 Interface의 주소를 사용하며 목적지 주소는 네트워크 환경에 따라서
  Unicast와 Multicast를 병행하여 사용한다.
  Ethernet과 같은 Broadcast Multi-Access구간에서는 목적지를 Multicast(224.0.0.10)를 사용하며
  PPP , HDLC , Frme-relay구간에서는 목적지 주소를 Unicast를 사용한다.




            # Reply
-Query에 대한 응답 Packet으로 대체경로의 유/무를 확인한다.

-Reply는 출발지주소를 출구 Interface의 주소를 사용하며 목적지 주소는 Unicast만을 사용한다.





            # ACK
-Update , Query , Reply에 대한 확인 Packet
-만약 ACK를 수신하지 못하게되면 EIGRP는 최대 16회까지 재전송을 실시하며
  그이후에도 ACK를 수신하지 못하게되면 인접성을 단절한다.

-ACK는 출발지주소를 출구 Interface의 주소를 사용하며 목적지 주소는 Unicast만을 사용한다.

헬로는 인접성맺고 인접성 유지. 네이버 테이블 등록하고 업데이트 를 하고.
최적경로 가 끊어졋으면 쿼리를 통해 대채경로가 있냐고 물어보고 리플라이 받고
리플라이 받을때에는 애크부터무조껀 받아야된다.
-------------------------------------------------------------------------------------

                            ## Dual알고리즘

-일반적인 라우팅은 하나의 목적지에 대해서 복수개의 경로가 존재하게되면
  최적경로를 선출하여 사용하며 해당 경로에 장애 발생시 나머지 경로에 대해서
  재 계산을 실시하여 최적경로를 선출하서 통신을 실시한다.

-EIGRP연산에 의해 Topology table상에서 Successor(최적경로)를 선출하여
  Routing table등록을 실시한후 Dual알고리즘에의해 Feasible Successor(차선경로)를 선출한다.

-FD : 출발지부터 목적지까지의 총거리
-AD : 출발지부터 Next-hop까지의 거리를 제외한 나머지 거리
-FD값이 실제 Metric값으로 사용되어지며 AD는 Dual계산시에만 사용된다.

            # Dual조건
1.가장 작은 FD값을 가진 경로가 Successor로 선출되어 Routing table에 등록된다.
2.Successor의 FD보다 작은 AD값을 가진 경로가 Feasible Successor로 선출된다.
3.2번 조건을 만족한 경로가 다수일경우 
  2번조건을 만족한 경로중 가장 작은 FD값을 가진 경로가 Feasible Successor로 선출된다.






Ex) 다음 중 Feasible Successsor가 있는 네트워크 정보는 누구인가? 

A) P 172.16.2.0/24, 2 successors, FD is 2297856
          via 34.34.12.2 (2297856/128256), Serial0/0
          via 34.34.14.2 (2297856/128256), Serial0/1

B) P 172.16.2.0/24, 1 successors, FD is 2297856
          via 34.34.12.2 (2297856/128256), Serial0/0
          via 34.34.14.2 (3756017/2297856), Serial0/1

C) P 172.16.2.0/24, 1 successors, FD is 2297856
          via 34.34.12.2 (2297856/128256), Serial0/0
          via 34.34.14.2 (2756017/2044256), Serial0/1

D) P 172.16.2.0/24, 1 successors, FD is 2297856
          via 34.34.12.2 (2297856/128256), Serial0/0
          via 34.34.14.2 (3756017/2997856), Serial0/1





-------------------------------------------------------------------------------------------------------------------------------

와일드마스크 (Wildcard Mask)
-ACL등의 Filtering 기능구성시 네트워크의 범위를 지정시 사용.
-EIGRCP,OSPF Routing Protocol 구성시 네트워크 범위를 지정시 사용.


172.16.1.0/24
172.16.2.0/24
172.16.3.0/24



router rip
 version 2
no auto-summary
network 172.16.0.0

서브넷 마스크의 단점을 만들어서 쓸수있는 애가 와일드 마스크다.





 		##Subnetmask 와 WildcardMask의 차이점
		

#Subnetmask

-32 bit로 구성되며 1과 0의 연속적인 형식만 가능
-1 = 공통비트
-0 = 비 공통비트


#WildcardMask

-32 bit로 구성되며 1과 0의  불연속적인 형식만 가능
-0 = 공통비트
-1 = 비 공통비트



192.168.1.0/24		00000000.00000000.00000000.11111111 = 0.0.0.255


11000000.10101000.00000001.00000000
-----------------------------------
00000000.00000000.00000000.11111111



192.168.1.64/26   0.0.0.63 (192.168.1.64 ~ 192.168.1.127)


192.168.1.10 	  0.0.0.0 = Host

=======================================================================================================================
EX) 172.16.0.0/24 ~ 172.16.3.0/24 네트워크범위를 WildcardMask를 사용하여 지정하시오.

-172.16.0.0    0.0.0.255
-172.16.1.0    0.0.0.255
-172.16.2.0    0.0.0.255
-172.16.3.0    0.0.0.255


-10101100.10101000.000000 00.00000000
-10101100.10101000.000000 01.00000000
-10101100.10101000.000000 10.00000000
-10101100.10101000.000000 11.00000000


-00000000.00000000.000000 11.11111111 = 172.168.0.0   0.0.3.255


-172.168.00000 00.00000000
-172.168.00000 01.00000000
-172.168.00000 10.00000000
-172.168.00000 11.00000000


0.0.000000  11.11111111=172.168.0.0       0.0.3.255






EX) 172.16.0.0/24 ~ 172.16.7.0/24 네트워크범위를 WildcardMask를 사용하여 지정하시오.







-172.16.0.0    0.0.0.255
-172.16.1.0    0.0.0.255
-172.16.2.0    0.0.0.255
-172.16.3.0    0.0.0.255
-172.16.4.0    0.0.0.255
-172.16.5.0    0.0.0.255
-172.16.6.0    0.0.0.255
-172.16.7.0    0.0.0.255



-10101100.10101000.00000 000.00000000
-10101100.10101000.00000 001.00000000
-10101100.10101000.00000 010.00000000
-10101100.10101000.00000 011.00000000
-10101100.10101000.00000 100.00000000
-10101100.10101000.00000 101.00000000
-10101100.10101000.00000 110.00000000
-10101100.10101000.00000 111.00000000



  000000000.00000000.00000 111.11111111 =172.168.0.0 0.0.7.255



  11111111.11111111.11111 000.00000000 =172.168.0.0 255.255.248.0





EX2) 172.16.4.0/24 ~ 172.16.7.0/24 네트워크범위를 WildcardMask를 사용하여 지정하시오.




-10101100.10101000.000000 00.00000000
-10101100.10101000.000000 01.00000000
-10101100.10101000.000000 10.00000000
-10101100.10101000.000000 11.00000000


 00000000.00000000.000000 11.11111111 =172.168.0.0 0.0.0.3.255


 11111111.11111111.111111 00.00000000 =172.168.0.0 255.255.252.0








Ex1) 다이나믹스 실행후 EIGRP pre-config 설정 실시 (Routing table 확인 및 Next-hop 구간 통신)



정보확인
show ip route
show ip route eigrp
show ip protocol
show ip eigrp neighbor
show ip eigrp topology
debug eigrp packet hello | update | query | reply |ack



===============================================================================================================================



interface lookback 128
ip addres 128.28.8.1 255.255.255.0
ip addres 128.28.9.1 255.255.255.0 secondary
ip addres 128.28.10.1 255.255.255.0 secondary
ip addres 128.28.11.1 255.255.255.0 secondary
ip addres 128.28.12.1 255.255.255.0 secondary
ip addres 128.28.13.1 255.255.255.0 secondary
ip addres 128.28.14.1 255.255.255.0 secondary
ip addres 128.28.15.1 255.255.255.0 secondary


router eigpr 100

network 128.28.8.0 0.0.7.255




128.28.8.0/24 ~ 128.25.15/24 = 128.28.8.0 0.0.7.255
00000 000.
00000 111.

     128.28.8.0/21









interface serial 1/0
ip summary-addess eigrp 100 A.B.C.D SubnetMask



-------------------------------------------------------------------------------------------------------------------------------



172.16.0.0/24 ~ 172.16.255.0/24 네트워크 정보중


# 짝수 네트워크만


- 172.16.0000000 0.00000000
- 172.16.0000001 0.00000000
- 172.16.0000010 0.00000000
- 172.16.0000100 0.00000000
- 172.16.0001000 0.00000000
- 172.16.0010000 0.00000000
- 172.16.0100000 0.00000000
- 172.16.1000000 0.00000000
~
- 172.16.1111111 0.00000000


- 172.16.1111111 0 .11111111

---------------------------
- 0.  .0 1111111 0 .11111111 = 172.16.0.0 0.0.254.255









#홀수 네트워크만



- 172.16.0000000 1.00000000
- 172.16.0000001 1.00000000
- 172.16.0000010 1.00000000
- 172.16.0000100 1.00000000
- 172.16.0001000 1.00000000
- 172.16.0010000 1.00000000
- 172.16.0100000 1.00000000
- 172.16.1000000 1.00000000
~
- 172.16.1111111 1.00000000


- 172.16.1111111 1 .11111111

---------------------------
- 0.  .0 1111111 0 .11111111 = 172.16.1.0 0.0.254.255




EX1)172.16.0.0/24 ~ 172.16.15.0/24 네트워크 정보중




#짝수 네트워크만



#홀수 네트워크만





디스턴스 백터 계열 리퀘스트방식을 결합해서 만든 방식.
		   링크 스테이트는 인접성을 맺게되어있다.



EIGRP
.자동 요약(auto-summary) 기능이 enable되어 있다.
	(Distance Vector 계열의 Routing Protocol은 "auto-summary"기능이 Default로 enable로 되어있다
.Split-horizon알고리즘에 의해 Loop를 방지한다. (Distance Vector계열의  Routing Protocol의 Loop방지 알고리즘)
.링크 스테이트의 특징- 인접성(Adjacency)이 맺어진 Router간 라우팅 업데이트를 실시한다.
						(Link-State계열의 Routing Protocol은 인접성을 연결한다.)
.네트워크 환경에 변경이 있는 경우에만 라우팅 업데이트를 실시한다.
						(Link-State계열의 Routing Protocol은 인접성을 연결한다.)
.


네이버테이블   - 인증을 맺은 목록을 여기다 지정
토플리지 테이블- 모든 네트웍과 모든경로들이 집합 를 저장.최적 경로를 라우팅 테이블에 넘겨준다.
라우팅 테이블  - 최적 경로들의 집합.




 			S1/0									S1/1
			R1-------------------------------------------------------------------------R2


#R1
key chain EIGRP_AUTH
key 20130122
key-string CCNA1234


interface serial 1/0
ip authentication mode eigrp 100 md5
ip authentication key-chain eigrp 100 EIGRP_AUTH


#R2

key chain EIGRP_AUTH
key 20130122
key-string CCNA1234


interface serial 1/1
ip authentication mode eigrp 100 md5
ip authentication key-chain eigrp 100 EIGRP_AUTH



EIGRP 듀얼 알고리즘. 반장뽑았는데 부반장 뽑아놓는다( 반장이 없을때 부반장이 대신 일을 맡아서 하는 그런 개념)




-AD (administative Distance)
Connecte:0
Static :1
EIGRP  :90
OSPF   :110
RIP    :120

-EIGRP Metric
EIGRP는 5가지 속성값을 복합연산한다.
Bandwidth , Load , Delay , Reliability , MTU

K상수 : K1= 1 ,K2= 0  ,K3= 1 ,K4= 0  ,K5= 0 ,

밴드위스는 대역폭 ==반비례== 딜레이는 시간개념.

EIGRP Metric= EIGRP B/W + EIGRP Delay = (10^7/목적지까지 최소의 Bandwidth) * 256 + (목적지까지 Delay의 합/10 ) * 256
EIGRP Bandwidth : (10^7/목적지까지 최소의 Bandwidth) * 256 
EIGRP Delay     : (목적지까지 Delay의 합/10 ) * 256

Bandwidth개념: 가장작은걸 쓰게되어있다. 큰걸보내봐야 다음속도가 작으면 그걸 따라가게 되어있으니까.


대부분의 모든 프로토콜은 균등분할



EIGRP 만 비균등 분할

variance (1-128)
가상으로 매트릭을 나눠서 등록할수있게 해주는 명령어



    		# 비균등 로드분산




-비균등 로드분산을 실시하기 위해서는 하나의 목적지에 대해서 매트릭이 동일하지 않아야하므로 매트릭 조건을 변경 실시[밴드위스변경]


hrd.go.kr



